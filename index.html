<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title></title>

    <link rel="stylesheet" media="all" href="http://potherca.github.io/CssBase/css/base.css" />

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script src="https://rawgithub.com/chjj/marked/master/lib/marked.js"></script>
    <script>
        var sUrl = 'readme.md';
        // @TODO: The location.hash needs to be checked to see if another file has been asked for.
        $.get(sUrl, function(p_sResult) {
            var sHtml;
            // Clicks on any link to local/relative markdown files need to be 
            // caught and handled through AJAX, also the location.hash should be
            // updated to reflect this.
            sHtml = marked(p_sResult);
            $('body').html(sHtml);
            addMenu();
        });
        // For this specific purpose things could be taken even further than this...
        //
        // Any code block that use PHP could be caught and posted to the IDEone 
        // API and the result could be added to the page. Or we could run the 
        // script locally, save the output, commit that to the repo and use that
        // to display with the answer...
        //
        // For graphviz examples we could also use http://oodavid.com/gviz/

        /* Retrieve a list of available answers */
        function addMenu() {
            function foo(p_sCallback) {
                $.getJSON('https://api.github.com/repos/potherca/StackOverflow/git/refs/heads'
                    , function(p_oResponse, p_sStatus, p_oXHR) {
                        $.getJSON('https://api.github.com/repos/potherca/StackOverflow/git/trees/' + p_oResponse[0].object.sha
                            , function(p_oResponse, p_sStatus, p_oXHR) {
                                $.each(p_oResponse.tree, function(p_i, p_oTree){
                                    if(p_oTree.type === 'tree') {
                                        p_sCallback(p_oTree.path);
                                    }
                                });
                            }
                        );
                    }
                );
            }

            $('body').append($('<h2>Available Answers</h2>'));
            var $List = $('body').append($('<ul></ul>'));
            foo(function(p_sPath){
                var sContent = '<li><a href="' + p_sPath + '">' + p_sPath+ '<\/a><\/li>'
                $List.append(sContent);
            });    
        };
    </script>
</head>
<body>

    <p>Content could not be loaded. Please <a href="readme.md">visit the text version here</a>.</p>
    
</body>
</html>
